-- Função para criar embed corretamente
local function Create_Embed_Data(title, description)
    local embed = {
        title = title or "Título Padrão",
        description = description or "Descrição Padrão",
        fields = {},
        thumbnail = nil,
        footer = nil,  -- Inicializar como nil
        image = nil,
        author = nil   -- Inicializar como nil
    }
    
    function embed:add_field(name, value, inline)
        table.insert(self.fields, {name = name, value = value, inline = inline or false})
    end

    function embed:set_thumbnail(url)
        self.thumbnail = {url = url}
    end

    function embed:set_footer(text, icon_url)
        self.footer = {text = text, icon_url = icon_url}
    end

    function embed:set_image(url)
        self.image = {url = url}
    end

    function embed:set_author(name, url, icon_url)
        self.author = {name = name, url = url, icon_url = icon_url}
    end

    return embed
end

-- Função para enviar webhook
local function Send_New_Webhook(webhook_url, content, embedsData)
    if not webhook_url or webhook_url == "" then
        return "Error: webhook URL doesn't exist"
    end
    if not content or content == "" then
        return "Error: content doesn't exist"
    end
    
    local data = {
        content = content,
        embeds = embedsData or {}  -- Garantir que `embeds` seja uma tabela vazia se não for fornecido
    }

    local newdata = game:GetService("HttpService"):JSONEncode(data)
    
    local headers = {
        ["Content-Type"] = "application/json"
    }
    
    local requestData = {
        Url = tostring(webhook_url),
        Body = newdata,
        Method = "POST",
        Headers = headers,
    }

    local function getRequestFunction()
        if http_request then
            return http_request
        elseif request then
            return request
        elseif HttpPost then
            return HttpPost
        elseif syn and syn.request then
            return syn.request
        else
            error("[ ❌ ] ╺╸ Your exploit does not support HTTP requests!\n[ ❌ ] ╺╸ Possible solutions:\n[ ❌ ] ╺╸ - Use another exploit\n[ ❌ ] ╺╸ - Use another script executor\n[ ❌ ] ╺╸ - Use another script environment\n[ ❌ ] ╺╸ - The game has a good AntiCheat")
        end
    end

    local requestFunction = getRequestFunction()
    local response = requestFunction(requestData)

    if response.StatusCode == 204 then
        print("[ ✅ ] ╺╸ Success: ", response.Success)
        print("[ ✅ ] ╺╸ WebHook Sent with Success")
    else
        print("[ ❌ ] ╺╸ Error While Sending WebHook ", response.StatusMessage)
    end
end

-- Retornar funções para serem usadas com loadstring
return {
    Create_Embed_Data = Create_Embed_Data,
    Send_New_Webhook = Send_New_Webhook
}
